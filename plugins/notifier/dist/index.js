import{useRpc as be,send as xe,message as we}from"@koishijs/client";import{defineComponent as ve,inject as Ae,computed as Se,resolveComponent as K,createElementBlock as Oe,openBlock as re,Fragment as Ce,renderList as $e,createBlock as je,withCtx as De,createVNode as _e,unref as Be,h as U}from"vue";var ke=Object.defineProperty,c=(e,i)=>ke(e,"name",{value:i,configurable:true});function Ne(){}c(Ne,"noop");function D(e){return e==null}c(D,"isNullable");function W(e){return!D(e)}c(W,"isNonNullable");function ze(e){return e&&typeof e=="object"&&!Array.isArray(e)}c(ze,"isPlainObject");function Re(e,i){return Object.fromEntries(Object.entries(e).filter(([l,h])=>i(l,h)))}c(Re,"filterKeys");function Fe(e,i){return Object.fromEntries(Object.entries(e).map(([l,h])=>[l,i(h,l)]))}c(Fe,"mapValues");function Pe(e,i,l){if(!i)return{...e};const h={};for(const s of i)(l||e[s]!==void 0)&&(h[s]=e[s]);return h}c(Pe,"pick");function Me(e,i){if(!i)return{...e};const l={...e};for(const h of i)Reflect.deleteProperty(l,h);return l}c(Me,"omit");function J(e,i,l){return Object.defineProperty(e,i,{writable:true,value:l,enumerable:false})}c(J,"defineProperty");function Le(e,i){return i.every(l=>e.includes(l))}c(Le,"contain");function Ue(e,i){return e.filter(l=>i.includes(l))}c(Ue,"intersection");function He(e,i){return e.filter(l=>!i.includes(l))}c(He,"difference");function Ve(e,i){return Array.from(new Set([...e,...i]))}c(Ve,"union");function Ee(e){return[...new Set(e)]}c(Ee,"deduplicate");function Ie(e,i){const l=e==null?void 0:e.indexOf(i);return l>=0?(e.splice(l,1),true):false}c(Ie,"remove");function ie(e){return Array.isArray(e)?e:D(e)?[]:[e]}c(ie,"makeArray");function _(e,i){return arguments.length===1?l=>_(e,l):e in globalThis&&i instanceof globalThis[e]||Object.prototype.toString.call(i).slice(8,-1)===e}c(_,"is");function P(e){return _("ArrayBuffer",e)||_("SharedArrayBuffer",e)}c(P,"isArrayBufferLike");function oe(e){return P(e)||ArrayBuffer.isView(e)}c(oe,"isArrayBufferSource");var B;(e=>{e.is=P,e.isSource=oe;function i(a){return ArrayBuffer.isView(a)?a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength):a}e.fromSource=i,c(i,"fromSource");function l(a){if(typeof Buffer<"u")return Buffer.from(a).toString("base64");let n="";const u=new Uint8Array(a);for(let y=0;y<u.byteLength;y++)n+=String.fromCharCode(u[y]);return btoa(n)}e.toBase64=l,c(l,"toBase64");function h(a){return typeof Buffer<"u"?i(Buffer.from(a,"base64")):Uint8Array.from(atob(a),n=>n.charCodeAt(0))}e.fromBase64=h,c(h,"fromBase64");function s(a){return typeof Buffer<"u"?Buffer.from(a).toString("hex"):Array.from(new Uint8Array(a),n=>n.toString(16).padStart(2,"0")).join("")}e.toHex=s,c(s,"toHex");function d(a){if(typeof Buffer<"u")return i(Buffer.from(a,"hex"));const n=a.length%2===0?a:a.slice(0,a.length-1),u=[];for(let y=0;y<n.length;y+=2)u.push(parseInt(`${n[y]}${n[y+1]}`,16));return Uint8Array.from(u).buffer}e.fromHex=d,c(d,"fromHex")})(B||(B={}));B.fromBase64;B.toBase64;B.fromHex;B.toHex;function G(e,i=new Map){if(!e||typeof e!="object")return e;if(_("Date",e))return new Date(e.valueOf());if(_("RegExp",e))return new RegExp(e.source,e.flags);if(P(e))return e.slice(0);if(ArrayBuffer.isView(e))return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);const l=i.get(e);if(l)return l;if(Array.isArray(e)){const s=[];return i.set(e,s),e.forEach((d,a)=>{s[a]=Reflect.apply(G,null,[d,i])}),s}const h=Object.create(Object.getPrototypeOf(e));i.set(e,h);for(const s of Reflect.ownKeys(e)){const d={...Reflect.getOwnPropertyDescriptor(e,s)};"value"in d&&(d.value=Reflect.apply(G,null,[d.value,i])),Reflect.defineProperty(h,s,d)}return h}c(G,"clone");function Q(e,i,l){if(e===i||!l&&D(e)&&D(i))return true;if(typeof e!=typeof i||typeof e!="object"||!e||!i)return false;function h(s,d){return s(e)?s(i)?d(e,i):false:s(i)?false:void 0}return c(h,"check"),h(Array.isArray,(s,d)=>s.length===d.length&&s.every((a,n)=>Q(a,d[n])))??h(_("Date"),(s,d)=>s.valueOf()===d.valueOf())??h(_("RegExp"),(s,d)=>s.source===d.source&&s.flags===d.flags)??h(P,(s,d)=>{if(s.byteLength!==d.byteLength)return false;const a=new Uint8Array(s),n=new Uint8Array(d);for(let u=0;u<a.length;u++)if(a[u]!==n[u])return false;return true})??Object.keys({...e,...i}).every(s=>Q(e[s],i[s],l))}c(Q,"deepEqual");function Ye(e){return e.charAt(0).toUpperCase()+e.slice(1)}c(Ye,"capitalize");function Ke(e){return e.charAt(0).toLowerCase()+e.slice(1)}c(Ke,"uncapitalize");function fe(e){return e.replace(/[_-][a-z]/g,i=>i.slice(1).toUpperCase())}c(fe,"camelCase");function X(e,i,l){const h=[];let s=0;for(let d=0;d<e.length;d++){const a=e.charCodeAt(d);if(a>=65&&a<=90){if(s===1){const n=e.charCodeAt(d+1);n>=97&&n<=122&&h.push(l),h.push(a+32)}else s!==0&&h.push(l),h.push(a+32);s=1}else a>=97&&a<=122?(h.push(a),s=2):i.includes(a)?(s!==0&&h.push(l),s=0):h.push(a)}return String.fromCharCode(...h)}c(X,"tokenize");function ae(e){return X(e,[45,95],45)}c(ae,"paramCase");function We(e){return X(e,[45,95],95)}c(We,"snakeCase");var Je=fe,Ge=ae;function Qe(e){return typeof e!="string"?`[${e.toString()}]`:/^[a-z_$][\w$]*$/i.test(e)?`.${e}`:`[${JSON.stringify(e)}]`}c(Qe,"formatProperty");function se(e){return e.replace(/\/$/,"")}c(se,"trimSlash");function Xe(e){return e.startsWith("/")||(e="/"+e),se(e)}c(Xe,"sanitize");var ne;(e=>{e.millisecond=1,e.second=1e3,e.minute=e.second*60,e.hour=e.minute*60,e.day=e.hour*24,e.week=e.day*7;let i=new Date().getTimezoneOffset();function l(p){i=p}e.setTimezoneOffset=l,c(l,"setTimezoneOffset");function h(){return i}e.getTimezoneOffset=h,c(h,"getTimezoneOffset");function s(p=new Date,g){return typeof p=="number"&&(p=new Date(p)),g===void 0&&(g=i),Math.floor((p.valueOf()/e.minute-g)/1440)}e.getDateNumber=s,c(s,"getDateNumber");function d(p,g){const H=new Date(p*e.day);return g===void 0&&(g=i),new Date(+H+g*e.minute)}e.fromDateNumber=d,c(d,"fromDateNumber");const a=/\d+(?:\.\d+)?/.source,n=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(p=>`(${a}${p})?`).join("")}$`);function u(p){const g=n.exec(p);return g?(parseFloat(g[1])*e.week||0)+(parseFloat(g[2])*e.day||0)+(parseFloat(g[3])*e.hour||0)+(parseFloat(g[4])*e.minute||0)+(parseFloat(g[5])*e.second||0):0}e.parseTime=u,c(u,"parseTime");function y(p){const g=u(p);return g?p=Date.now()+g:/^\d{1,2}(:\d{1,2}){1,2}$/.test(p)?p=`${new Date().toLocaleDateString()}-${p}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(p)&&(p=`${new Date().getFullYear()}-${p}`),p?new Date(p):new Date}e.parseDate=y,c(y,"parseDate");function S(p){const g=Math.abs(p);return g>=e.day-e.hour/2?Math.round(p/e.day)+"d":g>=e.hour-e.minute/2?Math.round(p/e.hour)+"h":g>=e.minute-e.second/2?Math.round(p/e.minute)+"m":g>=e.second?Math.round(p/e.second)+"s":p+"ms"}e.format=S,c(S,"format");function O(p,g=2){return p.toString().padStart(g,"0")}e.toDigits=O,c(O,"toDigits");function j(p,g=new Date){return p.replace("yyyy",g.getFullYear().toString()).replace("yy",g.getFullYear().toString().slice(2)).replace("MM",O(g.getMonth()+1)).replace("dd",O(g.getDate())).replace("hh",O(g.getHours())).replace("mm",O(g.getMinutes())).replace("ss",O(g.getSeconds())).replace("SSS",O(g.getMilliseconds(),3))}e.template=j,c(j,"template")})(ne||(ne={}));var Ze=Object.defineProperty,qe=Object.getOwnPropertyNames,x=(e,i)=>Ze(e,"name",{value:i,configurable:true}),Te=(e,i)=>function(){return i||(0,e[qe(e)[0]])((i={exports:{}}).exports,i),i.exports},et=Te({"src/index.ts"(e,i){var a;var l=Symbol.for("satori.element"),h=(a=class{get data(){return this.attrs}getTagName(){var u;return this.type==="component"?((u=this.attrs.is)==null?void 0:u.name)??"component":this.type}toAttrString(){return Object.entries(this.attrs).map(([u,y])=>D(y)?"":(u=Ge(u),y===true?` ${u}`:y===false?` no-${u}`:` ${u}="${s.escape(""+y,true)}"`)).join("")}toString(u=false){if(this.type==="text"&&"content"in this.attrs)return u?this.attrs.content:s.escape(this.attrs.content);const y=this.children.map(j=>j.toString(u)).join("");if(u)return y;const S=this.toAttrString(),O=this.getTagName();return this.children.length?`<${O}${S}>${y}</${O}>`:`<${O}${S}/>`}},x(a,"ElementConstructor"),a);J(h,"name","Element"),J(h.prototype,l,true);function s(n,...u){const y=Object.create(h.prototype),S={},O=[];if(u[0]&&typeof u[0]=="object"&&!s.isElement(u[0])&&!Array.isArray(u[0])){const j=u.shift();for(const[p,g]of Object.entries(j))D(g)||(p==="children"?u.push(...ie(g)):S[Je(p)]=g)}for(const j of u)O.push(...s.toElementArray(j));return typeof n=="function"&&(S.is=n,n="component"),Object.assign(y,{type:n,attrs:S,children:O})}x(s,"Element");var d=new Function("expr","context",`
  try {
    with (context) {
      return eval(expr)
    }
  } catch {}
`);(n=>{n.jsx=n,n.jsxs=n,n.jsxDEV=n,n.Fragment="template";function u(t){return t&&typeof t=="object"&&t[l]}n.isElement=u,x(u,"isElement");function y(t){if(typeof t=="string"||typeof t=="number"||typeof t=="boolean"){if(t=""+t,t)return n("text",{content:t})}else{if(u(t))return t;if(!D(t))throw new TypeError(`Invalid content: ${t}`)}}n.toElement=y,x(y,"toElement");function S(t){return Array.isArray(t)?t.map(y).filter(W):[y(t)].filter(W)}n.toElementArray=S,x(S,"toElementArray");function O(t,r){return typeof t=="string"?k(t,r):S(t)}n.normalize=O,x(O,"normalize");function j(t,r=false){const o=(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return r?o.replace(/"/g,"&quot;"):o}n.escape=j,x(j,"escape");function p(t){return t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#(\d+);/g,(r,o)=>o==="38"?r:String.fromCharCode(+o)).replace(/&#x([0-9a-f]+);/gi,(r,o)=>o==="26"?r:String.fromCharCode(parseInt(o,16))).replace(/&(amp|#38|#x26);/g,"&")}n.unescape=p,x(p,"unescape");function g(t,r={}){var f;const o=k(t);return r.caret?r.type&&((f=o[0])==null?void 0:f.type)!==r.type?void 0:o[0]:M(o,r.type||"*")[0]}n.from=g,x(g,"from");const H=/ *([ >+~]) */g;function V(t){return t.split(",").map(r=>{const o=[];r=r.trim();let f,m=" ";for(;f=H.exec(r);)o.push({type:r.slice(0,f.index),combinator:m}),m=f[1],r=r.slice(f.index+f[0].length);return o.push({type:r,combinator:m}),o})}n.parseSelector=V,x(V,"parseSelector");function M(t,r){if(!t||!r)return[];if(typeof t=="string"&&(t=k(t)),typeof r=="string"&&(r=V(r)),!r.length)return[];let o=[];const f=[];for(const[m,b]of t.entries()){const v=[],C=[...r,...o];o=[];let w=false;for(const A of C){const{type:$,combinator:L}=A[0];($===b.type||$==="*")&&(A.length===1?w=true:[" ",">"].includes(A[1].combinator)?v.push(A.slice(1)):A[1].combinator==="+"?o.push(A.slice(1)):r.push(A.slice(1))),L===" "&&v.push(A)}w&&f.push(t[m]),f.push(...M(b.children,v))}return f}n.select=M,x(M,"select");function R(t,r){if(t=t.trim(),!/^[\w.]+$/.test(t))return d(t,r)??"";let o=r;for(const f of t.split("."))if(o=o[f],D(o))return"";return o??""}n.interpolate=R,x(R,"interpolate");const ue=/(?<comment><!--[\s\S]*?-->)|(?<tag><(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>)/,le=/(?<comment><!--[\s\S]*?-->)|(?<tag><(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>)|(?<curly>\{(?<derivative>[@:/#][^\s}]*)?[\s\S]*?\})/,ce=/([^\s=]+)(?:="(?<value1>[^"]*)"|='(?<value2>[^']*)')?/g,pe=/([^\s=]+)(?:="(?<value1>[^"]*)"|='(?<value2>[^']*)'|=\{(?<curly>[^}]+)\})?/g;let Z;(t=>{t[t.OPEN=0]="OPEN",t[t.CLOSE=1]="CLOSE",t[t.EMPTY=2]="EMPTY",t[t.CONTINUE=3]="CONTINUE"})(Z||(Z={}));function k(t,r){const o=[];function f(w){w&&o.push(w)}x(f,"pushText");const m=r?le:ue;let b,v=true;for(;b=m.exec(t);){const{curly:w,comment:A,derivative:$}=b.groups,L=!w;C(t.slice(0,b.index),v,L),v=L,t=t.slice(b.index+b[0].length);const[he,,,de,ge,ye,me]=b;if(!A){if(w){let ee="",te=2;$&&(ee=$.slice(1),te={"@":2,"#":0,"/":1,":":3}[$[0]]),o.push({type:"curly",name:ee,position:te,source:w,extra:w.slice(1+($??"").length,-1)});continue}o.push({type:"angle",source:he,name:ge||n.Fragment,position:de?1:me?2:0,extra:ye})}}C(t,v,true);function C(w,A,$){w=p(w),A&&(w=w.replace(/^\s*\n\s*/,"")),$&&(w=w.replace(/\s*\n\s*$/,"")),f(w)}return x(C,"parseContent"),N(q(o),r)}n.parse=k,x(k,"parse");function q(t){const r=[[{type:"angle",name:n.Fragment,position:0,source:"",extra:"",children:{default:[]}},"default"]];function o(...f){const[m,b]=r[0];m.children[b].push(...f)}x(o,"pushToken");for(const f of t){if(typeof f=="string"){o(f);continue}const{name:m,position:b}=f;b===1?r[0][0].name===m&&r.shift():b===3?(r[0][0].children[m]=[],r[0][1]=m):b===0?(o(f),f.children={default:[]},r.unshift([f,"default"])):o(f)}return r[r.length-1][0].children.default}x(q,"foldTokens");function N(t,r){const o=[];for(const f of t)if(typeof f=="string")o.push(n("text",{content:f}));else if(f.type==="angle"){const m={},b=r?pe:ce;let v;for(;v=b.exec(f.extra);){const[,C,w,A=w,$]=v;$?m[C]=R($,r):D(A)?C.startsWith("no-")?m[C.slice(3)]=false:m[C]=true:m[C]=p(A)}o.push(n(f.name,m,f.children&&N(f.children.default,r)))}else if(!f.name)o.push(...S(R(f.extra,r)));else if(f.name==="if")d(f.extra,r)?o.push(...N(f.children.default,r)):o.push(...N(f.children.else||[],r));else if(f.name==="each"){const[m,b]=f.extra.split(/\s+as\s+/),v=R(m,r);if(!v||!v[Symbol.iterator])continue;for(const C of v)o.push(...N(f.children.default,{...r,[b]:C}))}return o}x(N,"parseTokens");function E(t,r,o){const{type:f,attrs:m,children:b}=t;if(typeof r=="function")return r(t,o);{let v=r[typeof f=="string"?f:""]??r.default??true;return typeof v=="function"&&(v=v(m,b,o)),v}}x(E,"visit");function I(t,r,o){const f=typeof t=="string"?k(t):t,m=[];return f.forEach(b=>{const{type:v,attrs:C,children:w}=b,A=E(b,r,o);A===true?m.push(n(v,C,I(w,r,o))):A!==false&&m.push(...S(A))}),typeof t=="string"?m.join(""):m}n.transform=I,x(I,"transform");async function Y(t,r,o){const f=typeof t=="string"?k(t):t,m=(await Promise.all(f.map(async b=>{const{type:v,attrs:C,children:w}=b,A=await E(b,r,o);return A===true?[n(v,C,await Y(w,r,o))]:A!==false?S(A):[]}))).flat(1);return typeof t=="string"?m.join(""):m}n.transformAsync=Y,x(Y,"transformAsync");function F(t,...r){return(...o)=>{const f=n(t);return r.forEach((m,b)=>{D(o[b])||(f.attrs[m]=o[b])}),o[r.length]&&Object.assign(f.attrs,o[r.length]),f}}x(F,"createFactory"),n.warn=x(()=>{},"warn");function z(t){return(r,...o)=>{let f="base64://";return typeof o[0]=="string"&&(f=`data:${o.shift()};base64,`),_("Buffer",r)?r=f+r.toString("base64"):_("ArrayBuffer",r)?r=f+B.toBase64(r):ArrayBuffer.isView(r)&&(r=f+B.toBase64(r.buffer)),r.startsWith("base64://")&&(0,n.warn)('protocol "base64:" is deprecated and will be removed in the future, please use "data:" instead'),n(t,{...o[0],src:r})}}x(z,"createAssetFactory"),n.text=F("text","content"),n.at=F("at","id"),n.sharp=F("sharp","id"),n.quote=F("quote","id"),n.image=z("img"),n.img=z("img"),n.video=z("video"),n.audio=z("audio"),n.file=z("file");function T(t,r){return n("i18n",typeof t=="string"?{path:t}:t,r)}n.i18n=T,x(T,"i18n")})(s||(s={})),i.exports=s}});const tt=et(),rt=ve({__name:"config",setup(e){const i=Ae("manager.settings.current"),l=be(),h=Se(()=>l.value.notifiers.filter(a=>{var n;return((n=a.paths)==null?void 0:n.includes(i.value.path))&&a.content})),s=["div","ul","ol","li","br","span","p","img","audio","video","b","strong","i","em","u","ins","s","del","code"],d=({children:a},n)=>a.map(({type:u,attrs:y,children:S})=>{if(u==="text")return y.content;if(s.includes(u))return U(u,y,{default:()=>d({children:S})});if(u==="spl")return U("span",{class:"spoiler",...y},{default:()=>d({children:S})});if(u==="button")return U(K("el-button"),{...y,onClick:()=>xe("notifier/button",y.onClick)},{default:()=>d({children:S})});if(u==="progress")return U(K("el-progress"),y,{default:()=>d({children:S})});if(u==="template")return d({children:S})});return(a,n)=>{const u=K("k-comment");return re(true),Oe(Ce,null,$e(h.value,y=>(re(),je(u,{type:y.type},{default:De(()=>[_e(d,{children:Be(tt).parse(y.content)},null,8,["children"])]),_:2},1032,["type"]))),256)}}}),ot=e=>{e.slot({type:"plugin-details",component:rt,order:0}),e.on("notifier/message",({content:i,type:l})=>{e.effect(()=>{const h=we({message:i,type:l==="primary"?"info":l});return()=>h.close()})})};export{ot as default};
