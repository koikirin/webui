var qt=Object.defineProperty;var zt=(e,i,f)=>i in e?qt(e,i,{enumerable:true,configurable:true,writable:true,value:f}):e[i]=f;var O=(e,i,f)=>zt(e,typeof i!="symbol"?i+"":i,f);import{defineComponent as Ce,resolveComponent as be,createBlock as Se,openBlock as G,unref as j,withCtx as we,createElementVNode as ee,normalizeClass as Pt,createCommentVNode as st,createVNode as ke,inject as Ut,computed as Wt,createElementBlock as lt,Fragment as Ht}from"vue";import{VirtualList as Tt,store as L,Time as Ft,icons as Vt}from"@koishijs/client";var xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ft(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Gt(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var f=function s(){return this instanceof s?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};f.prototype=i.prototype}else f={};return Object.defineProperty(f,"__esModule",{value:true}),Object.keys(e).forEach(function(s){var h=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(f,s,h.get?h:{enumerable:true,get:function(){return e[s]}})}),f}var me,tt;function Jt(){if(tt)return me;tt=1;function e(){const f=/(Chrome|Chromium)\/(?<chromeVersion>\d+)\./.exec(navigator.userAgent);if(f)return Number.parseInt(f.groups.chromeVersion,10)}const i=e()>=69?{level:1,hasBasic:true,has256:false,has16m:false}:false;return me={stdout:i,stderr:i},me}var rt=Jt(),Yt=Object.defineProperty,m=(e,i)=>Yt(e,"name",{value:i,configurable:true});function Xt(){}m(Xt,"noop");function J(e){return e==null}m(J,"isNullable");function Qt(e){return!J(e)}m(Qt,"isNonNullable");function Zt(e){return e&&typeof e=="object"&&!Array.isArray(e)}m(Zt,"isPlainObject");function Kt(e,i){return Object.fromEntries(Object.entries(e).filter(([f,s])=>i(f,s)))}m(Kt,"filterKeys");function jt(e,i){return Object.fromEntries(Object.entries(e).map(([f,s])=>[f,i(s,f)]))}m(jt,"mapValues");function er(e,i,f){if(!i)return{...e};const s={};for(const h of i)(f||e[h]!==void 0)&&(s[h]=e[h]);return s}m(er,"pick");function tr(e,i){if(!i)return{...e};const f={...e};for(const s of i)Reflect.deleteProperty(f,s);return f}m(tr,"omit");function rr(e,i,f){return Object.defineProperty(e,i,{writable:true,value:f,enumerable:false})}m(rr,"defineProperty");function nr(e,i){return i.every(f=>e.includes(f))}m(nr,"contain");function ir(e,i){return e.filter(f=>i.includes(f))}m(ir,"intersection");function ar(e,i){return e.filter(f=>!i.includes(f))}m(ar,"difference");function or(e,i){return Array.from(new Set([...e,...i]))}m(or,"union");function sr(e){return[...new Set(e)]}m(sr,"deduplicate");function lr(e,i){const f=e==null?void 0:e.indexOf(i);return f>=0?(e.splice(f,1),true):false}m(lr,"remove");function fr(e){return Array.isArray(e)?e:J(e)?[]:[e]}m(fr,"makeArray");function N(e,i){return arguments.length===1?f=>N(e,f):e in globalThis&&i instanceof globalThis[e]||Object.prototype.toString.call(i).slice(8,-1)===e}m(N,"is");function Y(e){return N("ArrayBuffer",e)||N("SharedArrayBuffer",e)}m(Y,"isArrayBufferLike");function ut(e){return Y(e)||ArrayBuffer.isView(e)}m(ut,"isArrayBufferSource");var H;(e=>{e.is=Y,e.isSource=ut;function i(o){return ArrayBuffer.isView(o)?o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength):o}e.fromSource=i,m(i,"fromSource");function f(o){if(typeof Buffer<"u")return Buffer.from(o).toString("base64");let u="";const t=new Uint8Array(o);for(let a=0;a<t.byteLength;a++)u+=String.fromCharCode(t[a]);return btoa(u)}e.toBase64=f,m(f,"toBase64");function s(o){return typeof Buffer<"u"?i(Buffer.from(o,"base64")):Uint8Array.from(atob(o),u=>u.charCodeAt(0))}e.fromBase64=s,m(s,"fromBase64");function h(o){return typeof Buffer<"u"?Buffer.from(o).toString("hex"):Array.from(new Uint8Array(o),u=>u.toString(16).padStart(2,"0")).join("")}e.toHex=h,m(h,"toHex");function d(o){if(typeof Buffer<"u")return i(Buffer.from(o,"hex"));const u=o.length%2===0?o:o.slice(0,o.length-1),t=[];for(let a=0;a<u.length;a+=2)t.push(parseInt(`${u[a]}${u[a+1]}`,16));return Uint8Array.from(t).buffer}e.fromHex=d,m(d,"fromHex")})(H||(H={}));H.fromBase64;H.toBase64;H.fromHex;H.toHex;function Oe(e,i=new Map){if(!e||typeof e!="object")return e;if(N("Date",e))return new Date(e.valueOf());if(N("RegExp",e))return new RegExp(e.source,e.flags);if(Y(e))return e.slice(0);if(ArrayBuffer.isView(e))return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);const f=i.get(e);if(f)return f;if(Array.isArray(e)){const h=[];return i.set(e,h),e.forEach((d,o)=>{h[o]=Reflect.apply(Oe,null,[d,i])}),h}const s=Object.create(Object.getPrototypeOf(e));i.set(e,s);for(const h of Reflect.ownKeys(e)){const d={...Reflect.getOwnPropertyDescriptor(e,h)};"value"in d&&(d.value=Reflect.apply(Oe,null,[d.value,i])),Reflect.defineProperty(s,h,d)}return s}m(Oe,"clone");function Ee(e,i,f){if(e===i||!f&&J(e)&&J(i))return true;if(typeof e!=typeof i||typeof e!="object"||!e||!i)return false;function s(h,d){return h(e)?h(i)?d(e,i):false:h(i)?false:void 0}return m(s,"check"),s(Array.isArray,(h,d)=>h.length===d.length&&h.every((o,u)=>Ee(o,d[u])))??s(N("Date"),(h,d)=>h.valueOf()===d.valueOf())??s(N("RegExp"),(h,d)=>h.source===d.source&&h.flags===d.flags)??s(Y,(h,d)=>{if(h.byteLength!==d.byteLength)return false;const o=new Uint8Array(h),u=new Uint8Array(d);for(let t=0;t<o.length;t++)if(o[t]!==u[t])return false;return true})??Object.keys({...e,...i}).every(h=>Ee(e[h],i[h],f))}m(Ee,"deepEqual");function ur(e){return e.charAt(0).toUpperCase()+e.slice(1)}m(ur,"capitalize");function cr(e){return e.charAt(0).toLowerCase()+e.slice(1)}m(cr,"uncapitalize");function pr(e){return e.replace(/[_-][a-z]/g,i=>i.slice(1).toUpperCase())}m(pr,"camelCase");function Ae(e,i,f){const s=[];let h=0;for(let d=0;d<e.length;d++){const o=e.charCodeAt(d);if(o>=65&&o<=90){if(h===1){const u=e.charCodeAt(d+1);u>=97&&u<=122&&s.push(f),s.push(o+32)}else h!==0&&s.push(f),s.push(o+32);h=1}else o>=97&&o<=122?(s.push(o),h=2):i.includes(o)?(h!==0&&s.push(f),h=0):s.push(o)}return String.fromCharCode(...s)}m(Ae,"tokenize");function hr(e){return Ae(e,[45,95],45)}m(hr,"paramCase");function gr(e){return Ae(e,[45,95],95)}m(gr,"snakeCase");function yr(e){return typeof e!="string"?`[${e.toString()}]`:/^[a-z_$][\w$]*$/i.test(e)?`.${e}`:`[${JSON.stringify(e)}]`}m(yr,"formatProperty");function ct(e){return e.replace(/\/$/,"")}m(ct,"trimSlash");function dr(e){return e.startsWith("/")||(e="/"+e),ct(e)}m(dr,"sanitize");var te;(e=>{e.millisecond=1,e.second=1e3,e.minute=e.second*60,e.hour=e.minute*60,e.day=e.hour*24,e.week=e.day*7;let i=new Date().getTimezoneOffset();function f(p){i=p}e.setTimezoneOffset=f,m(f,"setTimezoneOffset");function s(){return i}e.getTimezoneOffset=s,m(s,"getTimezoneOffset");function h(p=new Date,y){return typeof p=="number"&&(p=new Date(p)),y===void 0&&(y=i),Math.floor((p.valueOf()/e.minute-y)/1440)}e.getDateNumber=h,m(h,"getDateNumber");function d(p,y){const S=new Date(p*e.day);return y===void 0&&(y=i),new Date(+S+y*e.minute)}e.fromDateNumber=d,m(d,"fromDateNumber");const o=/\d+(?:\.\d+)?/.source,u=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(p=>`(${o}${p})?`).join("")}$`);function t(p){const y=u.exec(p);return y?(parseFloat(y[1])*e.week||0)+(parseFloat(y[2])*e.day||0)+(parseFloat(y[3])*e.hour||0)+(parseFloat(y[4])*e.minute||0)+(parseFloat(y[5])*e.second||0):0}e.parseTime=t,m(t,"parseTime");function a(p){const y=t(p);return y?p=Date.now()+y:/^\d{1,2}(:\d{1,2}){1,2}$/.test(p)?p=`${new Date().toLocaleDateString()}-${p}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(p)&&(p=`${new Date().getFullYear()}-${p}`),p?new Date(p):new Date}e.parseDate=a,m(a,"parseDate");function l(p){const y=Math.abs(p);return y>=e.day-e.hour/2?Math.round(p/e.day)+"d":y>=e.hour-e.minute/2?Math.round(p/e.hour)+"h":y>=e.minute-e.second/2?Math.round(p/e.minute)+"m":y>=e.second?Math.round(p/e.second)+"s":p+"ms"}e.format=l,m(l,"format");function c(p,y=2){return p.toString().padStart(y,"0")}e.toDigits=c,m(c,"toDigits");function g(p,y=new Date){return p.replace("yyyy",y.getFullYear().toString()).replace("yy",y.getFullYear().toString().slice(2)).replace("MM",c(y.getMonth()+1)).replace("dd",c(y.getDate())).replace("hh",c(y.getHours())).replace("mm",c(y.getMinutes())).replace("ss",c(y.getSeconds())).replace("SSS",c(y.getMilliseconds(),3))}e.template=g,m(g,"template")})(te||(te={}));const mr={},_r=Object.freeze(Object.defineProperty({__proto__:null,default:mr},Symbol.toStringTag,{value:"Module"})),vr=Gt(_r);var _e,nt;function br(){if(nt)return _e;nt=1;var e=typeof Map=="function"&&Map.prototype,i=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,f=e&&i&&typeof i.get=="function"?i.get:null,s=e&&Map.prototype.forEach,h=typeof Set=="function"&&Set.prototype,d=Object.getOwnPropertyDescriptor&&h?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=h&&d&&typeof d.get=="function"?d.get:null,u=h&&Set.prototype.forEach,t=typeof WeakMap=="function"&&WeakMap.prototype,a=t?WeakMap.prototype.has:null,l=typeof WeakSet=="function"&&WeakSet.prototype,c=l?WeakSet.prototype.has:null,g=typeof WeakRef=="function"&&WeakRef.prototype,p=g?WeakRef.prototype.deref:null,y=Boolean.prototype.valueOf,S=Object.prototype.toString,E=Function.prototype.toString,$=String.prototype.match,C=String.prototype.slice,k=String.prototype.replace,re=String.prototype.toUpperCase,Me=String.prototype.toLowerCase,Le=RegExp.prototype.test,Re=Array.prototype.concat,B=Array.prototype.join,yt=Array.prototype.slice,Ie=Math.floor,ne=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ie=Object.getOwnPropertySymbols,ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,P=typeof Symbol=="function"&&typeof Symbol.iterator=="object",T=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===P||true)?Symbol.toStringTag:null,De=Object.prototype.propertyIsEnumerable,Ne=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function qe(r,n){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||Le.call(/e/,n))return n;var v=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var b=r<0?-Ie(-r):Ie(r);if(b!==r){var w=String(b),_=C.call(n,w.length+1);return k.call(w,v,"$&_")+"."+k.call(k.call(_,/([0-9]{3})/g,"$&_"),/_$/,"")}}return k.call(n,v,"$&_")}var oe=vr,ze=oe.custom,Pe=Te(ze)?ze:null,Ue={__proto__:null,double:'"',single:"'"},dt={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};_e=function r(n,v,b,w){var _=v||{};if(M(_,"quoteStyle")&&!M(Ue,_.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(M(_,"maxStringLength")&&(typeof _.maxStringLength=="number"?_.maxStringLength<0&&_.maxStringLength!==1/0:_.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var I=M(_,"customInspect")?_.customInspect:true;if(typeof I!="boolean"&&I!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(M(_,"indent")&&_.indent!==null&&_.indent!=="	"&&!(parseInt(_.indent,10)===_.indent&&_.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(M(_,"numericSeparator")&&typeof _.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var z=_.numericSeparator;if(typeof n>"u")return"undefined";if(n===null)return"null";if(typeof n=="boolean")return n?"true":"false";if(typeof n=="string")return Ve(n,_);if(typeof n=="number"){if(n===0)return 1/0/n>0?"0":"-0";var x=String(n);return z?qe(n,x):x}if(typeof n=="bigint"){var D=String(n)+"n";return z?qe(n,D):D}var ue=typeof _.depth>"u"?5:_.depth;if(typeof b>"u"&&(b=0),b>=ue&&ue>0&&typeof n=="object")return se(n)?"[Array]":"[Object]";var U=It(_,b);if(typeof w>"u")w=[];else if(Fe(w,n)>=0)return"[Circular]";function A(W,Z,Nt){if(Z&&(w=yt.call(w),w.push(Z)),Nt){var et={depth:_.depth};return M(_,"quoteStyle")&&(et.quoteStyle=_.quoteStyle),r(W,et,b+1,w)}return r(W,_,b+1,w)}if(typeof n=="function"&&!He(n)){var Je=Et(n),Ye=X(n,A);return"[Function"+(Je?": "+Je:" (anonymous)")+"]"+(Ye.length>0?" { "+B.call(Ye,", ")+" }":"")}if(Te(n)){var Xe=P?k.call(String(n),/^(Symbol\(.*\))_[^)]*$/,"$1"):ae.call(n);return typeof n=="object"&&!P?F(Xe):Xe}if(Mt(n)){for(var V="<"+Me.call(String(n.nodeName)),ce=n.attributes||[],Q=0;Q<ce.length;Q++)V+=" "+ce[Q].name+"="+We(mt(ce[Q].value),"double",_);return V+=">",n.childNodes&&n.childNodes.length&&(V+="..."),V+="</"+Me.call(String(n.nodeName))+">",V}if(se(n)){if(n.length===0)return"[]";var pe=X(n,A);return U&&!Rt(pe)?"["+fe(pe,U)+"]":"[ "+B.call(pe,", ")+" ]"}if(vt(n)){var he=X(n,A);return!("cause"in Error.prototype)&&"cause"in n&&!De.call(n,"cause")?"{ ["+String(n)+"] "+B.call(Re.call("[cause]: "+A(n.cause),he),", ")+" }":he.length===0?"["+String(n)+"]":"{ ["+String(n)+"] "+B.call(he,", ")+" }"}if(typeof n=="object"&&I){if(Pe&&typeof n[Pe]=="function"&&oe)return oe(n,{depth:ue-b});if(I!=="symbol"&&typeof n.inspect=="function")return n.inspect()}if(Ct(n)){var Qe=[];return s&&s.call(n,function(W,Z){Qe.push(A(Z,n,true)+" => "+A(W,n))}),Ge("Map",f.call(n),Qe,U)}if($t(n)){var Ze=[];return u&&u.call(n,function(W){Ze.push(A(W,n))}),Ge("Set",o.call(n),Ze,U)}if(kt(n))return le("WeakMap");if(Bt(n))return le("WeakSet");if(At(n))return le("WeakRef");if(St(n))return F(A(Number(n)));if(xt(n))return F(A(ne.call(n)));if(wt(n))return F(y.call(n));if(bt(n))return F(A(String(n)));if(typeof window<"u"&&n===window)return"{ [object Window] }";if(typeof globalThis<"u"&&n===globalThis||typeof xe<"u"&&n===xe)return"{ [object globalThis] }";if(!_t(n)&&!He(n)){var ge=X(n,A),Ke=Ne?Ne(n)===Object.prototype:n instanceof Object||n.constructor===Object,ye=n instanceof Object?"":"null prototype",je=!Ke&&T&&Object(n)===n&&T in n?C.call(R(n),8,-1):ye?"Object":"",Dt=Ke||typeof n.constructor!="function"?"":n.constructor.name?n.constructor.name+" ":"",de=Dt+(je||ye?"["+B.call(Re.call([],je||[],ye||[]),": ")+"] ":"");return ge.length===0?de+"{}":U?de+"{"+fe(ge,U)+"}":de+"{ "+B.call(ge,", ")+" }"}return String(n)};function We(r,n,v){var b=v.quoteStyle||n,w=Ue[b];return w+r+w}function mt(r){return k.call(String(r),/"/g,"&quot;")}function q(r){return!T||!(typeof r=="object"&&(T in r||typeof r[T]<"u"))}function se(r){return R(r)==="[object Array]"&&q(r)}function _t(r){return R(r)==="[object Date]"&&q(r)}function He(r){return R(r)==="[object RegExp]"&&q(r)}function vt(r){return R(r)==="[object Error]"&&q(r)}function bt(r){return R(r)==="[object String]"&&q(r)}function St(r){return R(r)==="[object Number]"&&q(r)}function wt(r){return R(r)==="[object Boolean]"&&q(r)}function Te(r){if(P)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return true;if(!r||typeof r!="object"||!ae)return false;try{return ae.call(r),true}catch{}return false}function xt(r){if(!r||typeof r!="object"||!ne)return false;try{return ne.call(r),true}catch{}return false}var Ot=Object.prototype.hasOwnProperty||function(r){return r in this};function M(r,n){return Ot.call(r,n)}function R(r){return S.call(r)}function Et(r){if(r.name)return r.name;var n=$.call(E.call(r),/^function\s*([\w$]+)/);return n?n[1]:null}function Fe(r,n){if(r.indexOf)return r.indexOf(n);for(var v=0,b=r.length;v<b;v++)if(r[v]===n)return v;return-1}function Ct(r){if(!f||!r||typeof r!="object")return false;try{f.call(r);try{o.call(r)}catch{return true}return r instanceof Map}catch{}return false}function kt(r){if(!a||!r||typeof r!="object")return false;try{a.call(r,a);try{c.call(r,c)}catch{return true}return r instanceof WeakMap}catch{}return false}function At(r){if(!p||!r||typeof r!="object")return false;try{return p.call(r),true}catch{}return false}function $t(r){if(!o||!r||typeof r!="object")return false;try{o.call(r);try{f.call(r)}catch{return true}return r instanceof Set}catch{}return false}function Bt(r){if(!c||!r||typeof r!="object")return false;try{c.call(r,c);try{a.call(r,a)}catch{return true}return r instanceof WeakSet}catch{}return false}function Mt(r){return!r||typeof r!="object"?false:typeof HTMLElement<"u"&&r instanceof HTMLElement?true:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function Ve(r,n){if(r.length>n.maxStringLength){var v=r.length-n.maxStringLength,b="... "+v+" more character"+(v>1?"s":"");return Ve(C.call(r,0,n.maxStringLength),n)+b}var w=dt[n.quoteStyle||"single"];w.lastIndex=0;var _=k.call(k.call(r,w,"\\$1"),/[\x00-\x1f]/g,Lt);return We(_,"single",n)}function Lt(r){var n=r.charCodeAt(0),v={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];return v?"\\"+v:"\\x"+(n<16?"0":"")+re.call(n.toString(16))}function F(r){return"Object("+r+")"}function le(r){return r+" { ? }"}function Ge(r,n,v,b){var w=b?fe(v,b):B.call(v,", ");return r+" ("+n+") {"+w+"}"}function Rt(r){for(var n=0;n<r.length;n++)if(Fe(r[n],`
`)>=0)return false;return true}function It(r,n){var v;if(r.indent==="	")v="	";else if(typeof r.indent=="number"&&r.indent>0)v=B.call(Array(r.indent+1)," ");else return null;return{base:v,prev:B.call(Array(n+1),v)}}function fe(r,n){if(r.length===0)return"";var v=`
`+n.prev+n.base;return v+B.call(r,","+v)+`
`+n.prev}function X(r,n){var v=se(r),b=[];if(v){b.length=r.length;for(var w=0;w<r.length;w++)b[w]=M(r,w)?n(r[w],r):""}var _=typeof ie=="function"?ie(r):[],I;if(P){I={};for(var z=0;z<_.length;z++)I["$"+_[z]]=_[z]}for(var x in r)M(r,x)&&(v&&String(Number(x))===x&&x<r.length||P&&I["$"+x]instanceof Symbol||(Le.call(/[^\w$]/,x)?b.push(n(x,r)+": "+n(r[x],r)):b.push(x+": "+n(r[x],r))));if(typeof ie=="function")for(var D=0;D<_.length;D++)De.call(r,_[D])&&b.push("["+n(_[D])+"]: "+n(r[_[D]],r));return b}return _e}var Sr=br();const wr=ft(Sr);var xr=Object.create,$e=Object.defineProperty,Or=Object.getOwnPropertyDescriptor,pt=Object.getOwnPropertyNames,Er=Object.getPrototypeOf,Cr=Object.prototype.hasOwnProperty,K=(e,i)=>$e(e,"name",{value:i,configurable:true}),ht=(e,i)=>function(){return i||(0,e[pt(e)[0]])((i={exports:{}}).exports,i),i.exports},kr=(e,i,f,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let h of pt(i))!Cr.call(e,h)&&h!==f&&$e(e,h,{get:()=>i[h],enumerable:!(s=Or(i,h))||s.enumerable});return e},Ar=(e,i,f)=>(f=e!=null?xr(Er(e)):{},kr(!e||!e.__esModule?$e(f,"default",{value:e,enumerable:true}):f,e)),$r=ht({"src/shared.ts"(e,i){var o;var f=[6,2,3,4,5,1],s=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221];function h(u){return u instanceof Error&&Array.isArray(u.errors)}K(h,"isAggregateError");var d=(o=class{constructor(t,a){O(this,"extend",K(t2=>new o(`${this.name}:${t2}`,this.meta),"extend"));O(this,"warning",K((t2,...a2)=>{this.warn(t2,...a2)},"warning"));this.name=t,this.meta=a,this.createMethod("success",o.SUCCESS),this.createMethod("error",o.ERROR),this.createMethod("info",o.INFO),this.createMethod("warn",o.WARN),this.createMethod("debug",o.DEBUG)}static format(t,a){this.formatters[t]=a}static color(t,a,l,c=""){return t.colors?`\x1B[3${a<8?a:"8;5;"+a}${t.colors>=2?c:""}m${l}\x1B[0m`:""+l}static code(t,a){let l=0;for(let g=0;g<t.length;g++)l=(l<<3)-l+t.charCodeAt(g)+13,l|=0;const c=a.colors?a.colors>=2?s:f:[];return c[Math.abs(l)%c.length]}static render(t,a){var $,C,k;const l=`[${a.type[0].toUpperCase()}]`,c=" ".repeat((($=t.label)==null?void 0:$.margin)??1);let g=3+c.length,p="";t.showTime&&(g+=t.showTime.length+c.length,p+=o.color(t,8,te.template(t.showTime))+c);const y=o.code(a.name,t),S=o.color(t,y,a.name,";1"),E=(((C=t.label)==null?void 0:C.width)??0)+S.length-a.name.length;if(((k=t.label)==null?void 0:k.align)==="right"?(p+=S.padStart(E)+c+l+c,g+=(t.label.width??0)+c.length):p+=l+c+S.padEnd(E)+c,p+=a.content.replace(/\n/g,`
`+" ".repeat(g)),t.showDiff&&t.timestamp){const re=a.timestamp-t.timestamp;p+=o.color(t,y," +"+te.format(re))}return p}createMethod(t,a){this[t]=(...l)=>{if(l.length===1&&l[0]instanceof Error){if(l[0].cause)this[t](l[0].cause);else if(h(l[0])){l[0].errors.forEach(p=>this[t](p));return}}const c=++o.id,g=Date.now();for(const p of o.targets){if(this.getLevel(p)<a)continue;const y=this.format(p,...l),S={id:c,type:t,level:a,name:this.name,meta:this.meta,content:y,timestamp:g};if(p.record)p.record(S);else{const{print:E=console.log}=p;E(o.render(p,S))}p.timestamp=g}}}format(t,...a){a[0]instanceof Error?(a[0]=a[0].stack||a[0].message,a.unshift("%s")):typeof a[0]!="string"&&a.unshift("%o");let l=a.shift();l=l.replace(/%([a-zA-Z%])/g,(g,p)=>{if(g==="%%")return"%";const y=o.formatters[p];if(typeof y=="function"){const S=a.shift();return y(S,t,this)}return g});for(let g of a)typeof g=="object"&&g&&(g=o.formatters.o(g,t,this)),l+=" "+g;const{maxLength:c=10240}=t;return l.split(/\r?\n/g).map(g=>g.slice(0,c)+(g.length>c?"...":"")).join(`
`)}getLevel(t){const a=this.name.split(":");let l=(t==null?void 0:t.levels)||o.levels;do l=l[a.shift()]??l.base;while(a.length&&typeof l=="object");return l}get level(){return this.getLevel()}set level(t){const a=this.name.split(":");let l=o.levels;for(;a.length>1;){const c=a.shift(),g=l[c];typeof g=="object"?l=g:l=l[c]={base:g??l.base}}l[a[0]]=t}},K(o,"Logger"),O(o,"SILENT",0),O(o,"SUCCESS",1),O(o,"ERROR",1),O(o,"INFO",2),O(o,"WARN",2),O(o,"DEBUG",3),O(o,"id",0),O(o,"targets",[{colors:rt.stdout&&rt.stdout.level,print(t){console.log(t)}}]),O(o,"formatters",Object.create(null)),O(o,"levels",{base:2}),o);d.format("s",u=>u),d.format("d",u=>+u),d.format("j",u=>JSON.stringify(u)),d.format("c",(u,t,a)=>d.color(t,d.code(a.name,t),u)),d.format("C",(u,t)=>d.color(t,15,u,";1")),i.exports=d}}),Br=ht({"src/browser.ts"(e,i){var f=Ar($r());f.default.format("o",(s,h)=>wr(s,{depth:1/0}).replace(/\s*\n\s*/g," ")),i.exports=f.default}});const Mr=Br();var ve={},it;function Lr(){return it||(it=1,function(e){(function(i,f){if(typeof e.nodeName!="string")f(e);else{var s={};f(s),i.AnsiUp=s.default}})(xe,function(i){var f=this&&this.__makeTemplateObject||function(u,t){return Object.defineProperty?Object.defineProperty(u,"raw",{value:t}):u.raw=t,u},s;(function(u){u[u.EOS=0]="EOS",u[u.Text=1]="Text",u[u.Incomplete=2]="Incomplete",u[u.ESC=3]="ESC",u[u.Unknown=4]="Unknown",u[u.SGR=5]="SGR",u[u.OSCURL=6]="OSCURL"})(s||(s={}));var h=function(){function u(){this.VERSION="5.2.1",this.setup_palettes(),this._use_classes=false,this.bold=false,this.italic=false,this.underline=false,this.fg=this.bg=null,this._buffer="",this._url_whitelist={http:1,https:1},this._escape_html=true}return Object.defineProperty(u.prototype,"use_classes",{get:function(){return this._use_classes},set:function(t){this._use_classes=t},enumerable:false,configurable:true}),Object.defineProperty(u.prototype,"url_whitelist",{get:function(){return this._url_whitelist},set:function(t){this._url_whitelist=t},enumerable:false,configurable:true}),Object.defineProperty(u.prototype,"escape_html",{get:function(){return this._escape_html},set:function(t){this._escape_html=t},enumerable:false,configurable:true}),u.prototype.setup_palettes=function(){var t=this;this.ansi_colors=[[{rgb:[0,0,0],class_name:"ansi-black"},{rgb:[187,0,0],class_name:"ansi-red"},{rgb:[0,187,0],class_name:"ansi-green"},{rgb:[187,187,0],class_name:"ansi-yellow"},{rgb:[0,0,187],class_name:"ansi-blue"},{rgb:[187,0,187],class_name:"ansi-magenta"},{rgb:[0,187,187],class_name:"ansi-cyan"},{rgb:[255,255,255],class_name:"ansi-white"}],[{rgb:[85,85,85],class_name:"ansi-bright-black"},{rgb:[255,85,85],class_name:"ansi-bright-red"},{rgb:[0,255,0],class_name:"ansi-bright-green"},{rgb:[255,255,85],class_name:"ansi-bright-yellow"},{rgb:[85,85,255],class_name:"ansi-bright-blue"},{rgb:[255,85,255],class_name:"ansi-bright-magenta"},{rgb:[85,255,255],class_name:"ansi-bright-cyan"},{rgb:[255,255,255],class_name:"ansi-bright-white"}]],this.palette_256=[],this.ansi_colors.forEach(function($){$.forEach(function(C){t.palette_256.push(C)})});for(var a=[0,95,135,175,215,255],l=0;l<6;++l)for(var c=0;c<6;++c)for(var g=0;g<6;++g){var p={rgb:[a[l],a[c],a[g]],class_name:"truecolor"};this.palette_256.push(p)}for(var y=8,S=0;S<24;++S,y+=10){var E={rgb:[y,y,y],class_name:"truecolor"};this.palette_256.push(E)}},u.prototype.escape_txt_for_html=function(t){return this._escape_html?t.replace(/[&<>"']/gm,function(a){if(a==="&")return"&amp;";if(a==="<")return"&lt;";if(a===">")return"&gt;";if(a==='"')return"&quot;";if(a==="'")return"&#x27;"}):t},u.prototype.append_buffer=function(t){var a=this._buffer+t;this._buffer=a},u.prototype.get_next_packet=function(){var t={kind:s.EOS,text:"",url:""},a=this._buffer.length;if(a==0)return t;var l=this._buffer.indexOf("\x1B");if(l==-1)return t.kind=s.Text,t.text=this._buffer,this._buffer="",t;if(l>0)return t.kind=s.Text,t.text=this._buffer.slice(0,l),this._buffer=this._buffer.slice(l),t;if(l==0){if(a<3)return t.kind=s.Incomplete,t;var c=this._buffer.charAt(1);if(c!="["&&c!="]"&&c!="(")return t.kind=s.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;if(c=="["){this._csi_regex||(this._csi_regex=d(f([`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \x1B[                      # CSI
                          ([<-?]?)              # private-mode char
                          ([d;]*)                    # any digits or semicolons
                          ([ -/]?               # an intermediate modifier
                          [@-~])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \x1B[                      # CSI
                          [ -~]*                # anything legal
                          ([\0-:])              # anything illegal
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                                                    # First attempt
                        (?:                         # legal sequence
                          \\x1b\\[                      # CSI
                          ([\\x3c-\\x3f]?)              # private-mode char
                          ([\\d;]*)                    # any digits or semicolons
                          ([\\x20-\\x2f]?               # an intermediate modifier
                          [\\x40-\\x7e])                # the command
                        )
                        |                           # alternate (second attempt)
                        (?:                         # illegal sequence
                          \\x1b\\[                      # CSI
                          [\\x20-\\x7e]*                # anything legal
                          ([\\x00-\\x1f:])              # anything illegal
                        )
                    `])));var g=this._buffer.match(this._csi_regex);if(g===null)return t.kind=s.Incomplete,t;if(g[4])return t.kind=s.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;g[1]!=""||g[3]!="m"?t.kind=s.Unknown:t.kind=s.SGR,t.text=g[2];var p=g[0].length;return this._buffer=this._buffer.slice(p),t}else if(c=="]"){if(a<4)return t.kind=s.Incomplete,t;if(this._buffer.charAt(2)!="8"||this._buffer.charAt(3)!=";")return t.kind=s.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;this._osc_st||(this._osc_st=o(f([`
                        (?:                         # legal sequence
                          (\x1B\\)                    # ESC                           |                           # alternate
                          (\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\0-]                 # anything illegal
                          |                           # alternate
                          [\b-]                 # anything illegal
                          |                           # alternate
                          [-]                 # anything illegal
                        )
                    `],[`
                        (?:                         # legal sequence
                          (\\x1b\\\\)                    # ESC \\
                          |                           # alternate
                          (\\x07)                      # BEL (what xterm did)
                        )
                        |                           # alternate (second attempt)
                        (                           # illegal sequence
                          [\\x00-\\x06]                 # anything illegal
                          |                           # alternate
                          [\\x08-\\x1a]                 # anything illegal
                          |                           # alternate
                          [\\x1c-\\x1f]                 # anything illegal
                        )
                    `]))),this._osc_st.lastIndex=0;{var y=this._osc_st.exec(this._buffer);if(y===null)return t.kind=s.Incomplete,t;if(y[3])return t.kind=s.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t}{var S=this._osc_st.exec(this._buffer);if(S===null)return t.kind=s.Incomplete,t;if(S[3])return t.kind=s.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t}this._osc_regex||(this._osc_regex=d(f([`
                        ^                           # beginning of line
                                                    #
                        \x1B]8;                    # OSC Hyperlink
                        [ -:<-~]*       # params (excluding ;)
                        ;                           # end of params
                        ([!-~]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                        ([ -~]+)              # TEXT capture
                        \x1B]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\x1B\\)                  # ESC                           |                           # alternate
                          (?:\x07)                    # BEL (what xterm did)
                        )
                    `],[`
                        ^                           # beginning of line
                                                    #
                        \\x1b\\]8;                    # OSC Hyperlink
                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)
                        ;                           # end of params
                        ([\\x21-\\x7e]{0,512})        # URL capture
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                        ([\\x20-\\x7e]+)              # TEXT capture
                        \\x1b\\]8;;                   # OSC Hyperlink End
                        (?:                         # ST
                          (?:\\x1b\\\\)                  # ESC \\
                          |                           # alternate
                          (?:\\x07)                    # BEL (what xterm did)
                        )
                    `])));var g=this._buffer.match(this._osc_regex);if(g===null)return t.kind=s.ESC,t.text=this._buffer.slice(0,1),this._buffer=this._buffer.slice(1),t;t.kind=s.OSCURL,t.url=g[1],t.text=g[2];var p=g[0].length;return this._buffer=this._buffer.slice(p),t}else if(c=="(")return t.kind=s.Unknown,this._buffer=this._buffer.slice(3),t}},u.prototype.ansi_to_html=function(t){this.append_buffer(t);for(var a=[];;){var l=this.get_next_packet();if(l.kind==s.EOS||l.kind==s.Incomplete)break;l.kind==s.ESC||l.kind==s.Unknown||(l.kind==s.Text?a.push(this.transform_to_html(this.with_state(l))):l.kind==s.SGR?this.process_ansi(l):l.kind==s.OSCURL&&a.push(this.process_hyperlink(l)))}return a.join("")},u.prototype.with_state=function(t){return{bold:this.bold,italic:this.italic,underline:this.underline,fg:this.fg,bg:this.bg,text:t.text}},u.prototype.process_ansi=function(t){for(var a=t.text.split(";");a.length>0;){var l=a.shift(),c=parseInt(l,10);if(isNaN(c)||c===0)this.fg=this.bg=null,this.bold=false,this.italic=false,this.underline=false;else if(c===1)this.bold=true;else if(c===3)this.italic=true;else if(c===4)this.underline=true;else if(c===22)this.bold=false;else if(c===23)this.italic=false;else if(c===24)this.underline=false;else if(c===39)this.fg=null;else if(c===49)this.bg=null;else if(c>=30&&c<38)this.fg=this.ansi_colors[0][c-30];else if(c>=40&&c<48)this.bg=this.ansi_colors[0][c-40];else if(c>=90&&c<98)this.fg=this.ansi_colors[1][c-90];else if(c>=100&&c<108)this.bg=this.ansi_colors[1][c-100];else if((c===38||c===48)&&a.length>0){var g=c===38,p=a.shift();if(p==="5"&&a.length>0){var y=parseInt(a.shift(),10);y>=0&&y<=255&&(g?this.fg=this.palette_256[y]:this.bg=this.palette_256[y])}if(p==="2"&&a.length>2){var S=parseInt(a.shift(),10),E=parseInt(a.shift(),10),$=parseInt(a.shift(),10);if(S>=0&&S<=255&&E>=0&&E<=255&&$>=0&&$<=255){var C={rgb:[S,E,$],class_name:"truecolor"};g?this.fg=C:this.bg=C}}}}},u.prototype.transform_to_html=function(t){var a=t.text;if(a.length===0||(a=this.escape_txt_for_html(a),!t.bold&&!t.italic&&!t.underline&&t.fg===null&&t.bg===null))return a;var l=[],c=[],g=t.fg,p=t.bg;t.bold&&l.push("font-weight:bold"),t.italic&&l.push("font-style:italic"),t.underline&&l.push("text-decoration:underline"),this._use_classes?(g&&(g.class_name!=="truecolor"?c.push(g.class_name+"-fg"):l.push("color:rgb("+g.rgb.join(",")+")")),p&&(p.class_name!=="truecolor"?c.push(p.class_name+"-bg"):l.push("background-color:rgb("+p.rgb.join(",")+")"))):(g&&l.push("color:rgb("+g.rgb.join(",")+")"),p&&l.push("background-color:rgb("+p.rgb+")"));var y="",S="";return c.length&&(y=' class="'+c.join(" ")+'"'),l.length&&(S=' style="'+l.join(";")+'"'),"<span"+S+y+">"+a+"</span>"},u.prototype.process_hyperlink=function(t){var a=t.url.split(":");if(a.length<1||!this._url_whitelist[a[0]])return"";var l='<a href="'+this.escape_txt_for_html(t.url)+'">'+this.escape_txt_for_html(t.text)+"</a>";return l},u}();function d(u){var t=u.raw[0],a=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,l=t.replace(a,"");return new RegExp(l)}function o(u){var t=u.raw[0],a=/^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm,l=t.replace(a,"");return new RegExp(l,"g")}Object.defineProperty(i,"__esModule",{value:true}),i.default=h})}(ve)),ve}var Rr=Lr();const at=ft(Rr),Ir=["innerHTML"],ot="yyyy-MM-dd hh:mm:ss",Dr=Ce({__name:"logs",props:{logs:{},showLink:{type:Boolean},maxHeight:{}},setup(e){const i=e,f=new(at.default||at);function s(o,u,t=""){return`\x1B[3${o<8?o:"8;5;"+o}${t}m${u}\x1B[0m`}function h(o){return o.index&&i.logs[o.index-1].id>o.id&&o.name==="app"}function d(o){const u=`[${o.type[0].toUpperCase()}]`,t=" ";let a=3+t.length,l="";a+=ot.length+t.length,l+=s(8,Ft.template(ot,new Date(o.timestamp)))+t;const c=Mr.code(o.name,{colors:3}),g=s(c,o.name,";1"),p=g.length-o.name.length;return l+=u+t+g.padEnd(p)+t,l+=o.content.replace(/\n/g,`
`+" ".repeat(a)),f.ansi_to_html(l)}return(o,u)=>{const t=be("k-icon"),a=be("router-link");return G(),Se(j(Tt),{class:"log-list k-text-selectable",data:e.logs,count:300,"max-height":e.maxHeight},{default:we(l=>{var c,g;return[ee("div",{class:Pt({line:true,start:h(l)})},[ee("code",{innerHTML:d(l)},null,8,Ir),e.showLink&&j(L).config&&j(L).packages&&((g=(c=l.meta)==null?void 0:c.paths)!=null&&g.length)?(G(),Se(a,{key:0,class:"log-link inline-flex items-center justify-center absolute w-20px h-20px bottom-0 right-0",to:"/plugins/"+l.meta.paths[0].replace(/\./,"/")},{default:we(()=>[ke(t,{name:"arrow-right"})]),_:1},8,["to"])):st("v-if",true)],2)]}),_:1},8,["data","max-height"])}}}),Be=(e,i)=>{const f=e.__vccOpts||e;for(const[s,h]of i)f[s]=h;return f},gt=Be(Dr,[["__scopeId","data-v-f399e7fe"]]),Nr=Ce({__name:"index",setup(e){return(i,f)=>{const s=be("k-layout");return G(),Se(s,null,{default:we(()=>[ke(gt,{class:"layout-logger",logs:j(L).logs,"show-link":""},null,8,["logs"])]),_:1})}}}),qr=Ce({__name:"settings",setup(e){const i=Ut("manager.settings.current"),f=Wt(()=>{var d,o;if(!L.logs)return[];const s=[];let h=1/0;for(let u=L.logs.length-1;u>0&&!(L.logs[u].id>=h);--u)h=L.logs[u].id,(o=(d=L.logs[u].meta)==null?void 0:d.paths)!=null&&o.includes(i.value.path)&&s.unshift(L.logs[u]);return s});return(s,h)=>{var d;return(d=f.value)!=null&&d.length?(G(),lt(Ht,{key:0},[h[0]||(h[0]=ee("h2",{class:"k-schema-header"}," 运行日志 ",-1)),ke(gt,{class:"settings-logger",logs:f.value,"max-height":"216px"},null,8,["logs"])],64)):st("v-if",true)}}}),zr=Be(qr,[["__scopeId","data-v-af449902"]]),Pr={},Ur={class:"k-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"};function Wr(e,i){return G(),lt("svg",Ur,[...i[0]||(i[0]=[ee("path",{fill:"currentColor",d:"M304 336h-128C167.2 336 160 343.2 160 352s7.156 16 16 16h128c8.844 0 16-7.156 16-16S312.8 336 304 336zM304 240h-96C199.2 240 192 247.2 192 256s7.156 16 16 16h96C312.8 272 320 264.8 320 256S312.8 240 304 240zM96 328c-13.25 0-24 10.74-24 24c0 13.25 10.75 24 24 24c13.26 0 24-10.75 24-24C120 338.7 109.3 328 96 328zM320 64c-8.844 0-16 7.156-16 16S311.2 96 320 96c17.64 0 32 14.34 32 32v320c0 17.66-14.36 32-32 32H64c-17.64 0-32-14.34-32-32V128c0-17.66 14.36-32 32-32c8.844 0 16-7.156 16-16S72.84 64 64 64C28.7 64 0 92.72 0 128v320c0 35.28 28.7 64 64 64h256c35.3 0 64-28.72 64-64V128C384 92.72 355.3 64 320 64zM112 128h160C280.8 128 288 120.8 288 112S280.8 96 272 96h-24.88C252.6 86.55 256 75.72 256 64c0-35.35-28.65-64-64-64S128 28.65 128 64c0 11.72 3.379 22.55 8.877 32H112C103.2 96 96 103.2 96 112S103.2 128 112 128zM192 32c17.64 0 32 14.36 32 32s-14.36 32-32 32S160 81.64 160 64S174.4 32 192 32zM68.25 229.2c-6 6.5-5.594 16.59 .9062 22.59l34.66 32C106.9 286.6 110.8 288 114.7 288c4.203 0 8.406-1.656 11.55-4.938l61.33-64c6.125-6.375 5.906-16.5-.4844-22.62c-6.359-6.094-16.48-5.906-22.61 .5L113.1 249.6L90.84 228.3C84.39 222.3 74.22 222.6 68.25 229.2z"},null,-1)])])}const Hr=Be(Pr,[["render",Wr]]);Vt.register("activity:logs",Hr);const Gr=e=>{e.page({path:"/logs",name:"日志",icon:"activity:logs",order:0,authority:4,fields:["logs"],component:Nr}),e.slot({type:"plugin-details",component:zr,order:-800})};export{Gr as default};
